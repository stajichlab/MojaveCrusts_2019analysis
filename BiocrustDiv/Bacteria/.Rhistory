tax_filtered <- tax[tax$OTU.ID %in% otu$OTU.ID,]
head(tax_filtered)
dim(tax_filtered)
dim(otu)
tax_filtered = tax_filtered[,c(1,2)]
tax_filtered = separate(tax_filtered, Taxon, c("Kingdom","Phylum","Class","Order", "Family", "Genus","Species"), sep= ";", remove=TRUE)
dim(tax_filtered)
head(tax_filtered)
write.csv(tax_filtered, file="taxonomy_phyloseq_fix.csv")
otus <- read.table("MojaveBacQ2FWLEsilva515806.otu_table.fix.txt",
header=T,sep="\t",row.names = 1)
otumat <- as(as.matrix(otus), "matrix")
OTU = otu_table(otumat, taxa_are_rows = TRUE)
taxmat <- read.csv("taxonomy_phyloseq_fix.csv",
sep=",",row.names=1)
row.names(taxmat) = taxmat$OTU.ID
taxmat <- as(as.matrix(taxmat),"matrix")
TAX = tax_table(taxmat)
treefile = "tree.nwk"
tree = read.tree(treefile)
meta = read.table("Mojave_mappingfile_8-Aug-2018.txt",
header=TRUE,row.names=1,
sep="\t",stringsAsFactors=FALSE)
meta <- meta[which(meta$Layer %in% c("Surface")),]
head(meta)
sampleData <- sample_data(meta)
physeq = phyloseq(OTU,TAX,sampleData,tree)
physeq
physeq.prune = prune_taxa(taxa_sums(physeq) > 5, physeq)
physeq.prune
readcount = data.table(as(sample_data(physeq.prune), "data.frame"),
TotalReads = sample_sums(physeq.prune),
keep.rownames = TRUE)
setnames(readcount, "rn", "SampleID")
#For plotting, use command below.
#SeqDepth = ggplot(readcount, aes(TotalReads)) + geom_histogram() + ggtitle("Sequencing Depth")
readcount = readcount[order(readcount$TotalReads), c("SampleID", "TotalReads")]
head(readcount)
set.seed(711)
physeq.prune.rarefy = rarefy_even_depth(physeq.prune, sample.size = 37386, replace = FALSE, trimOTUs = TRUE)
physeq.prune.rarefy
physeq.prune.rarefy.plot.richness.Crust_type = plot_richness(physeq.prune.rarefy, x="Crust_type", color=("Crust_type"), measures=c("Observed")) + geom_boxplot() + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Crust type") + stat_compare_means(method = "anova", label.y = 3000) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "LAC", label.y = 2800, hide.ns = TRUE) + theme_bw() + theme(plot.title = element_text(hjust = 0.5))
physeq.prune.rarefy.plot.richness.Crust_type
physeq.prune.rarefy.plot.richness.Crust_type = plot_richness(physeq.prune.rarefy, x="Crust_type", color=("Crust_type"), measures=c("Observed")) + geom_boxplot() + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Crust type") + stat_compare_means(method = "anova", label.y = 1300) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "LAC", label.y = 1200, hide.ns = TRUE) + theme_bw() + theme(plot.title = element_text(hjust = 0.5))
physeq.prune.rarefy.plot.richness.Crust_type
physeq.prune.rarefy.plot.richness.Crust_type = plot_richness(physeq.prune.rarefy, x="Crust_type", color=("Crust_type"), measures=c("Chao1")) + geom_boxplot() + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Crust type") + stat_compare_means(method = "anova", label.y = 1300) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "LAC", label.y = 1200, hide.ns = TRUE) + theme_bw() + theme(plot.title = element_text(hjust = 0.5))
physeq.prune.rarefy.plot.richness.Crust_type
physeq.prune.rarefy.plot.richness.Crust_type = plot_richness(physeq.prune.rarefy, x="Crust_type", color=("Crust_type"), measures=c("Observed")) + geom_boxplot() + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Crust type") + stat_compare_means(method = "anova", label.y = 1300) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "LAC", label.y = 1200, hide.ns = TRUE) + theme_bw() + theme(plot.title = element_text(hjust = 0.5))
physeq.prune.rarefy.plot.richness.Crust_type
meta = read.table("Mojave_mappingfile_8-Aug-2018.txt",
header=TRUE,row.names=1,
sep="\t",stringsAsFactors=FALSE)
#meta <- meta[which(meta$Layer %in% c("Surface")),]
sampleData <- sample_data(meta)
physeq = phyloseq(OTU,TAX,sampleData,tree)
physeq
physeq.prune = prune_taxa(taxa_sums(physeq) > 5, physeq)
physeq.prune
readcount = data.table(as(sample_data(physeq.prune), "data.frame"),
TotalReads = sample_sums(physeq.prune),
keep.rownames = TRUE)
setnames(readcount, "rn", "SampleID")
#For plotting, use command below.
#SeqDepth = ggplot(readcount, aes(TotalReads)) + geom_histogram() + ggtitle("Sequencing Depth")
readcount = readcount[order(readcount$TotalReads), c("SampleID", "TotalReads")]
head(readcount)
set.seed(711)
physeq.prune.rarefy = rarefy_even_depth(physeq.prune, sample.size = 37435, replace = FALSE, trimOTUs = TRUE)
physeq.prune.rarefy
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy, x="Site_layer", color=("Site_layer"), measures=c("Observed")) + geom_boxplot() + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 3000) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP_SF", label.y = 2800, hide.ns = TRUE) + theme_bw() + theme(plot.title = element_text(hjust = 0.5)) + scale_x_discrete(limits=c("JNTP_SF","CIMA_SF", "GMT_SF", "KELSO_SF", "JNTP_Sub","CIMA_Sub", "GMT_Sub", "KELSO_Sub")) + scale_color_discrete(breaks=c("JNTP_SF","CIMA_SF", "GMT_SF", "KELSO_SF", "JNTP_Sub","CIMA_Sub", "GMT_Sub", "KELSO_Sub"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy, x="Site_layer", color=("Site_layer"), measures=c("Observed")) + geom_boxplot() + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 3000) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP_SF", label.y = 2800, hide.ns = TRUE) + theme_bw() + theme(plot.title = element_text(hjust = 0.5)) + scale_x_discrete(limits=c("JTNP_SF","CIMA_SF", "GMT_SF", "KELSO_SF", "JTNP_Sub","CIMA_Sub", "GMT_Sub", "KELSO_Sub")) + scale_color_discrete(breaks=c("JTNP_SF","CIMA_SF", "GMT_SF", "KELSO_SF", "JTNP_Sub","CIMA_Sub", "GMT_Sub", "KELSO_Sub"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy, x="Site_layer", color=("Site_layer"), measures=c("Observed")) + geom_boxplot() + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + scale_x_discrete(limits=c("JTNP_SF","CIMA_SF", "GMT_SF", "KELSO_SF", "JTNP_Sub","CIMA_Sub", "GMT_Sub", "KELSO_Sub")) + scale_color_discrete(breaks=c("JTNP_SF","CIMA_SF", "GMT_SF", "KELSO_SF", "JTNP_Sub","CIMA_Sub", "GMT_Sub", "KELSO_Sub")) + stat_compare_means(method = "anova", label.y = 3000) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP_SF", label.y = 2800, hide.ns = TRUE) + theme_bw() + theme(plot.title = element_text(hjust = 0.5))
physeq.prune.rarefy.plot.richness.Site_layer
sample_data(mydata)$Site_layer = factor(sample_data(mydata)$Site_layer, levels = c("JTNP_SF","CIMA_SF", "GMT_SF", "KELSO_SF", "JTNP_Sub","CIMA_Sub", "GMT_Sub", "KELSO_Sub"))
sample_data(physeq.prune.rarefy)$Site_layer = factor(sample_data(physeq.prune.rarefy)$Site_layer, levels = c("JTNP_SF","CIMA_SF", "GMT_SF", "KELSO_SF", "JTNP_Sub","CIMA_Sub", "GMT_Sub", "KELSO_Sub"))
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy, x="Site_layer", color=("Site_layer"), measures=c("Observed")) + geom_boxplot() + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 3000) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP_SF", label.y = 2800, hide.ns = TRUE) + theme_bw() + theme(plot.title = element_text(hjust = 0.5))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy, x="Site_layer", color=("Site_layer"), measures=c("Observed")) + geom_boxplot() + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 3000) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP_SF", label.y = 2800, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.SF = subset_samples(physeq.prune.rarefy, Layer=="Surface")
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot() + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 3000) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 2800, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#FF0000", "#0000FF", "#00FF00"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot() + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 3000) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 2800, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#FF0000", "#0000FF", "#00FF00", "blue"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot() + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1300) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#FF0000", "#0000FF", "#00FF00", "blue"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.SF = subset_samples(physeq.prune.rarefy, Layer=="Surface")
sample_data(physeq.prune.rarefy.SF)$Site = factor(sample_data(physeq.prune.rarefy.SF)$Site, levels = c("JTNP","CIMA", "GMT", "KELSO"))
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot() + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1300) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#FF0000", "#0000FF", "#00FF00", "blue"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot() + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#FF0000", "#0000FF", "#00FF00", "blue"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot() + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("plum3", "palegreen2", "palegreen3", "palegreen4"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(fill="Site") + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("plum3", "palegreen2", "palegreen3", "palegreen4"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(fill=meta$Site) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("plum3", "palegreen2", "palegreen3", "palegreen4"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(fill="plum3", "palegreen2", "palegreen3", "palegreen4") + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("plum3", "palegreen2", "palegreen3", "palegreen4"))
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(fill=c("plum3", "palegreen2", "palegreen3", "palegreen4")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("plum3", "palegreen2", "palegreen3", "palegreen4"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(fill=c("plum3", "palegreen2", "palegreen3", "palegreen4")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#E69F00", "darkorange4", "grey28", "grey18"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(fill=c("#E69F00", "darkorange4", "grey28", "grey18")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#E69F00", "darkorange4", "grey28", "grey18"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(fill=c("#E69F00", "darkorange2", "grey38", "grey28")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#E69F00", "darkorange4", "grey28", "grey18"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(fill=c("darkorange2", "steelblue1", "steelblue2", "steelblue3")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("darkorange4", "steelblue2", "steelblue3", "steelblue4"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=3,fill=c("darkorange2", "steelblue1", "steelblue2", "steelblue3")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("darkorange4", "steelblue2", "steelblue3", "steelblue4"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=2,fill=c("darkorange2", "steelblue1", "steelblue2", "steelblue3")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("darkorange4", "steelblue2", "steelblue3", "steelblue4"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("darkorange2", "steelblue1", "steelblue2", "steelblue3")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("darkorange4", "steelblue2", "steelblue3", "steelblue4"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(,fill=c("darkorange2", "steelblue1", "steelblue2", "steelblue3")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("darkorange4", "steelblue2", "steelblue3", "steelblue4"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=0.5,fill=c("darkorange2", "steelblue1", "steelblue2", "steelblue3")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("darkorange4", "steelblue2", "steelblue3", "steelblue4"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("darkorange2", "steelblue1", "steelblue2", "steelblue3")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("darkorange4", "steelblue2", "steelblue3", "steelblue4"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("darkorange2", "steelblue1", "steelblue2", "steelblue3")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("darkorange4", "steelblue", "steelblue3", "steelblue4"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("darkorange2", "steelblue1", "steelblue2", "steelblue3")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("darkorange4", "steelblue3", "steelblue", "steelblue4"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("darkorange2", "steelblue3", "steelblue2", "steelblue1")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("darkorange4", "steelblue3", "steelblue", "steelblue4"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("darkorange2", "steelblue3", "steelblue2", "steelblue1")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("darkorange4", "steelblue3", "steelblue", "steelblue4")) + theme_bw()
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("darkorange2", "steelblue3", "steelblue2", "steelblue1")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("darkorange4", "steelblue3", "steelblue", "steelblue4"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("darkorange2", "lightblue", "lightblue1", "lightblue2")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("darkorange4", "steelblue3", "steelblue", "steelblue4"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("darkorange2", "lightblue1", "lightblue2", "lightblue3")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("darkorange4", "steelblue3", "steelblue", "steelblue4"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("darkorange2", "lightblue1", "lightblue2", "lightblue3")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#999999", "#E69F00", "#56B4E9", "#009E73"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73"))
physeq.prune.rarefy.plot.richness.Site_layer
alpha.diversity = estimate_richness(physeq.prune.rarefy, measures = c("Observed"))
data.anova = cbind(sample_data(physeq.prune.rarefy), alpha.diversity)
physeq.prune.rarefy.anova = aov(Observed ~ Site, data.anova)
summary(physeq.prune.rarefy.anova)
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73"))
physeq.prune.rarefy.plot.richness.Site_layer
alpha.diversity = estimate_richness(physeq.prune.rarefy, measures = c("Observed"))
data.anova = cbind(sample_data(physeq.prune.rarefy), alpha.diversity)
physeq.prune.rarefy.anova = aov(Observed ~ Site_layer, data.anova)
summary(physeq.prune.rarefy.anova)
knitr::opts_chunk$set(echo = TRUE)
#alpha.diversity = estimate_richness(physeq.prune.rarefy, measures = c("Shannon"))
#data.anova = cbind(sample_data(physeq.prune.rarefy), alpha.diversity)
physeq.prune.rarefy.anova = aov(Observed ~ Site, data=meta)
#alpha.diversity = estimate_richness(physeq.prune.rarefy, measures = c("Shannon"))
#data.anova = cbind(sample_data(physeq.prune.rarefy), alpha.diversity)
physeq.prune.rarefy.anova = aov(observed ~ Site, data=meta)
alpha.diversity = estimate_richness(physeq.prune.rarefy, measures = c("observed"))
alpha.diversity = estimate_richness(physeq.prune.rarefy, measures = c("Observed"))
data.anova = cbind(sample_data(physeq.prune.rarefy), alpha.diversity)
physeq.prune.rarefy.anova = aov(Observed ~ Site, data.anova)
summary(physeq.prune.rarefy.anova)
alpha.diversity = estimate_richness(physeq.prune.rarefy, measures = c("Chao1"))
data.anova = cbind(sample_data(physeq.prune.rarefy), alpha.diversity)
physeq.prune.rarefy.anova = aov(Chao1 ~ Site, data.anova)
summary(physeq.prune.rarefy.anova)
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73"))
physeq.prune.rarefy.plot.richness.Site_layer
alpha.diversity = estimate_richness(physeq.prune.rarefy.SF, measures = c("Observed"))
data.anova = cbind(sample_data(physeq.prune.rarefy.SF), alpha.diversity)
physeq.prune.rarefy.SF.anova = aov(Observed ~ Site, data.anova)
summary(physeq.prune.rarefy.SF.anova)
tukey.ps.SF = TukeyHSD(x=physeq.prune.rarefy.SF.anova, 'data.anova$Site', conf.level = 0.95)
plot(tukey.ps.SF)
tukey.ps.SF = TukeyHSD(x=physeq.prune.rarefy.SF.anova, 'physeq.prune.rarefy.SF.anova$Site', conf.level = 0.95)
plot(tukey.ps.SF)
tukey.ps.SF = TukeyHSD(x=physeq.prune.rarefy.SF.anova, physeq.prune.rarefy.SF.anova$Site, conf.level = 0.95)
tukey.ps.SF = TukeyHSD(x=physeq.prune.rarefy.SF.anova, data.anova$Site, conf.level = 0.95)
plot(tukey.ps.SF)
data.anova
physeq.prune.rarefy.SF.anova
tukey.ps.SF = TukeyHSD(x=physeq.prune.rarefy.SF.anova, Site, conf.level = 0.95)
tukey.ps.SF = TukeyHSD(x=physeq.prune.rarefy.SF.anova, 'Site', conf.level = 0.95)
plot(tukey.ps.SF)
generate_label_df <- function(tukey.ps.SF, variable){
# Extract labels and factor levels from Tukey post-hoc
Tukey.levels <- tukey.ps.SF[[variable]][,4]
Tukey.labels <- data.frame(multcompLetters(Tukey.levels)['Letters'])
#I need to put the labels in the same order as in the boxplot :
Tukey.labels$treatment=rownames(Tukey.labels)
Tukey.labels=Tukey.labels[order(Tukey.labels$treatment) , ]
return(Tukey.labels)
}
generate_label_df
generate_label_df
LABELS=generate_label_df(tukey.ps.SF, 'Site')
install.packages('multcompView')
library(multcompView)
LABELS=generate_label_df(tukey.ps.SF, 'Site')
LABELS
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(aes(label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(aes(label = b, ab, a, a))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(aes(label = 'b, ab, a, a'))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(aes(label = 'b', 'ab', 'a', 'a'))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data = LABELS, aes(x=x, y=y, label = LETTERS))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + stat_summary(geom = 'text', label = letters[1:3])
physeq.prune.rarefy.plot.richness.Site_layer
alpha.diversity
data.anova
physeq.prune.rarefy.SF.anova
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + stat_summary(geom = 'text', label = letters[1:4])
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + stat_compare_means(aes(label=..p.signif..), method = "t.test", ref.group = "JTNP", label.y = 1200, hide.ns = TRUE) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + stat_summary(geom = 'text', label = letters[1:4], fun.y = max, vjust = -1)
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1250) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + stat_summary(geom = 'text', label = letters[1:4], fun.y = max, vjust = -1)
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + stat_summary(geom = 'text', label = letters[1:4], fun.y = max, vjust = -1)
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data = LABELS, aes(x = treatment, y = 1000, label = LETTERS))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) #+ geom_text(data = LABELS, aes(x = treatment, y = 1000, label = LETTERS))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) #+ geom_text(data = LABELS, aes(x = treatment, y = 1000, label = LETTERS))
physeq.prune.rarefy.plot.richness.Site_layer + geom_text(data = LABELS, aes(x = treatment, y = 1000, label = LETTERS))
as.data.frame(LABELS)
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data = LABELS, aes(x = treatment, y = 1000, label = LETTERS))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data = LABELS, aes(x = treatment, y = LETTERS, label = LETTERS))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(aes(x = LABELS$treatment, y = 1000, label = LABELS$LETTERS))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + stat_summary(geom="text", fun.y=quantile,
aes(label=sprintf("%1.1f", ..y..), color=Site),
position=position_nudge(x=0.33), size=3.5) +
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + stat_summary(geom="text", fun.y=quantile,
aes(label=sprintf("%1.1f", ..y..), color='Site'),
position=position_nudge(x=0.33), size=3.5) +
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(aes(x = LABELS$treatment, y = 1000, label = LABELS$LETTERS))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(aes(label = LABELS$LETTERS))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(aes(x = "Site", y = "measures", label = LABELS$LETTERS))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(aes(x = "Site", y = c("Observed"), label = LABELS$LETTERS))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data = LABELS, aes(x = treatment , y = 1000, label = LABELS$LETTERS))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(aes(x = 2 , y = 1000, label = LABELS$LETTERS))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_label(data = LABELS)
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73"))
physeq.prune.rarefy.plot.richness.Site_layer + geom_label(data = LABELS)
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73"))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.SF.anova
physeq.prune.rarefy.SF.anova
names(labels) = c('Letters','Site')
names(LABELS) = c('Letters','Site')
yvalue = aggregate(.~Site, data = data.anova, mean)
yvalue = aggregate(.~Site, data = 'Site', mean)
yvalue = aggregate(.~Site, data = 'Observed', mean)
yvalue = aggregate(.~Site, data = data.anova$Site, mean)
yvalue = aggregate(.~Site, data = physeq.prune.rarefy.SF.anova, mean)
yvalue = aggregate(.~Site, data = alpha.diversity, mean)
LABELS
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, x=Site, label = Letters)
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, x=LABELS$Site, label = Letters)
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, x=LABELS$Site, label = LABELS$Letters)
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, x=LABELS$Site, y=1000, label = LABELS$Letters)
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, x=LABELS$Site, y=1000, label = LABELS$Letters, vjust=-3.5, hjust=-0.5)
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, x='LABELS$Site', y = 1000, label = LABELS$Letters, vjust=-3.5, hjust=-0.5)
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, x='LABELS$Site', y = 1000, label = 'LABELS$Letters', vjust=-3.5, hjust=-0.5)
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, x=c('LABELS$Site'), y = 1000, label = c('LABELS$Letters'), vjust=-3.5, hjust=-0.5)
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=c('LABELS$Site'), y = 1000, label = c('LABELS$Letters'), vjust=-3.5, hjust=-0.5))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1000, label = LABELS$Letters, vjust=-3.5, hjust=-0.5))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1100, label = LABELS$Letters, vjust=-3.5, hjust=-0.5))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1050, label = LABELS$Letters, vjust=-3.5, hjust=-0.5))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1025, label = LABELS$Letters, vjust=-3.5, hjust=-0.5))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1025, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1105, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1120, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "#E69F00", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1150, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "orange", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1150, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "goldenrod1", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1150, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1150, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "#56B4E9", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1150, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "cadetblue1", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1150, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "cadetblue2", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1150, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "cadetblue3", "#009E73")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1150, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "cadetblue3", "palegreen2")) + ggtitle("Mojave Biocrust Bacterial Alpha Diversity (Observed) by Site and Layer") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1150, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "cadetblue3", "palegreen2")) + ggtitle("Bacterial Alpha Diversity by Site") + stat_compare_means(method = "anova", label.y = 1200) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1150, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site_layer
pdf("./Figures/Bacterial Alpha Diversity by Site.pdf", width = 8, height = 5 )
physeq.prune.rarefy.plot.richness.Site_layer
dev.off()
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "cadetblue3", "palegreen2")) + ggtitle("Bacterial Alpha Diversity by Site") + stat_compare_means(method = "anova", label.y = 1250) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1150, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "cadetblue3", "palegreen2")) + ggtitle("Bacterial Alpha Diversity by Site") + stat_compare_means(method = "anova", label.y = 1205) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1150, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "cadetblue3", "palegreen2")) + ggtitle("Bacterial Alpha Diversity by Site") + stat_compare_means(method = "anova", label.y = 1210) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1150, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "cadetblue3", "palegreen2")) + ggtitle("Bacterial Alpha Diversity by Site") + stat_compare_means(method = "anova", label.y = 1215) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1150, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "cadetblue3", "palegreen2")) + ggtitle("Bacterial Alpha Diversity by Site") + stat_compare_means(method = "anova", label.y = 1218) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1150, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site_layer
physeq.prune.rarefy.plot.richness.Site_layer = plot_richness(physeq.prune.rarefy.SF, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "cadetblue3", "palegreen2")) + ggtitle("Bacterial Alpha Diversity by Site") + stat_compare_means(method = "anova", label.y = 1222) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1150, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site_layer
pdf("./Figures/Bacterial Alpha Diversity by Site.pdf", width = 8, height = 5 )
physeq.prune.rarefy.plot.richness.Site_layer
dev.off()
BacPhylum = as.character(get_taxa_unique(physeq.prune.rarefy.SF, "Phylum"))
BacPhylum = BacPhylum[complete.cases(BacPhylum)]
pdf("./Figures/Bacterial Phylum Alpha (Observed) Diversity by Site.pdf", width = 8, height = 5 )
for (i in BacPhylum) {
APS = subset_taxa(physeq.prune.rarefy, Phylum == i)
APS.plot = plot_richness(APS, x="Site_layer", color =("Site"), measures=c("Observed")) + geom_boxplot() + ggtitle(i) + stat_compare_means(method = "anova") + theme(plot.title = element_text(hjust = 0.5))
print(APS.plot)
}
dev.off()
pdf("./Figures/Bacterial Phylum Alpha (Observed) Diversity by Site.pdf", width = 8, height = 5 )
for (i in BacPhylum) {
APS = subset_taxa(physeq.prune.rarefy.SF, Phylum == i)
APS.plot = plot_richness(APS, x="Site_layer", color =("Site"), measures=c("Observed")) + geom_boxplot() + ggtitle(i) + stat_compare_means(method = "anova") + theme(plot.title = element_text(hjust = 0.5))
print(APS.plot)
}
dev.off()
physeq.prune.rarefy.SF.Acido = subset_taxa(physeq.prune.rarefy.SF, Phylum == Acidobacteria)
physeq.prune.rarefy.SF.Acido = subset_taxa(physeq.prune.rarefy.SF, Phylum == p__Acidobacteria)
physeq.prune.rarefy.SF.Acido = subset_taxa(physeq.prune.rarefy.SF, Phylum == D_1__Acidobacteria)
physeq.prune.rarefy.SF.Acido = subset_taxa(physeq.prune.rarefy.SF, Phylum == D_1_Acidobacteria)
BacPhylum = as.character(get_taxa_unique(physeq.prune.rarefy.SF, "Phylum"))
BacPhylum = BacPhylum[complete.cases(BacPhylum)]
BacPhylum
physeq.prune.rarefy.SF.Acido = subset_taxa(physeq.prune.rarefy.SF, Phylum == "D_1__Acidobacteria"")
alpha.diversity = estimate_richness(physeq.prune.rarefy.SF.Acido, measures = c("Observed"))
physeq.prune.rarefy.SF.Acido = subset_taxa(physeq.prune.rarefy.SF, Phylum == "D_1__Acidobacteria")
alpha.diversity = estimate_richness(physeq.prune.rarefy.SF.Acido, measures = c("Observed"))
data.anova = cbind(sample_data(physeq.prune.rarefy.SF.Acido), alpha.diversity)
physeq.prune.rarefy.SF.Acido.anova = aov(Observed ~ Site, data.anova)
tukey.ps.SF = TukeyHSD(x=physeq.prune.rarefy.SF.Acido.anova, 'Site', conf.level = 0.95)
LABELS=generate_label_df(tukey.ps.SF, 'Site')
names(LABELS) = c('Letters','Site')
physeq.prune.rarefy.plot.richness.Site.Acido = plot_richness(physeq.prune.rarefy.SF.Acido, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "cadetblue3", "palegreen2")) + ggtitle("Acidobacteria Alpha Diversity by Site") + stat_compare_means(method = "anova", label.y = 1222) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 1150, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site.Acido
physeq.prune.rarefy.plot.richness.Site.Acido = plot_richness(physeq.prune.rarefy.SF.Acido, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "cadetblue3", "palegreen2")) + ggtitle("Acidobacteria Alpha Diversity by Site") + stat_compare_means(method = "anova", label.y = 300) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 300, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site.Acido
physeq.prune.rarefy.plot.richness.Site.Acido = plot_richness(physeq.prune.rarefy.SF.Acido, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "cadetblue3", "palegreen2")) + ggtitle("Acidobacteria Alpha Diversity by Site") + stat_compare_means(method = "anova", label.y = 60) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 60, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site.Acido
physeq.prune.rarefy.plot.richness.Site.Acido = plot_richness(physeq.prune.rarefy.SF.Acido, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "cadetblue3", "palegreen2")) + ggtitle("Acidobacteria Alpha Diversity by Site") + stat_compare_means(method = "anova", label.y = 80) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 78, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site.Acido
physeq.prune.rarefy.plot.richness.Site.Acido = plot_richness(physeq.prune.rarefy.SF.Acido, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "cadetblue3", "palegreen2")) + ggtitle("Acidobacteria Alpha Diversity by Site") + stat_compare_means(method = "anova", label.y = 85) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 78, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site.Acido
physeq.prune.rarefy.SF.Acido = subset_taxa(physeq.prune.rarefy.SF, Phylum == "D_1__Proteobacteria")
alpha.diversity = estimate_richness(physeq.prune.rarefy.SF.Acido, measures = c("Observed"))
data.anova = cbind(sample_data(physeq.prune.rarefy.SF.Acido), alpha.diversity)
physeq.prune.rarefy.SF.Acido.anova = aov(Observed ~ Site, data.anova)
tukey.ps.SF = TukeyHSD(x=physeq.prune.rarefy.SF.Acido.anova, 'Site', conf.level = 0.95)
LABELS=generate_label_df(tukey.ps.SF, 'Site')
names(LABELS) = c('Letters','Site')
physeq.prune.rarefy.plot.richness.Site.Acido = plot_richness(physeq.prune.rarefy.SF.Acido, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "cadetblue3", "palegreen2")) + ggtitle("Proteobacteria Alpha Diversity by Site") + stat_compare_means(method = "anova", label.y = 85) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 78, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site.Acido
physeq.prune.rarefy.SF.Acido = subset_taxa(physeq.prune.rarefy.SF, Phylum == "D_1__Firmicutes")
alpha.diversity = estimate_richness(physeq.prune.rarefy.SF.Acido, measures = c("Observed"))
data.anova = cbind(sample_data(physeq.prune.rarefy.SF.Acido), alpha.diversity)
physeq.prune.rarefy.SF.Acido.anova = aov(Observed ~ Site, data.anova)
tukey.ps.SF = TukeyHSD(x=physeq.prune.rarefy.SF.Acido.anova, 'Site', conf.level = 0.95)
LABELS=generate_label_df(tukey.ps.SF, 'Site')
names(LABELS) = c('Letters','Site')
physeq.prune.rarefy.plot.richness.Site.Acido = plot_richness(physeq.prune.rarefy.SF.Acido, x="Site", color=("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "cadetblue3", "palegreen2")) + ggtitle("Firmicutes Alpha Diversity by Site") + stat_compare_means(method = "anova", label.y = 85) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73")) + geom_text(data=LABELS, aes(x=LABELS$Site, y = 78, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Site.Acido
pdf("./Figures/Bacterial Phylum Alpha (Observed) Diversity by Site.pdf", width = 8, height = 5 )
for (i in BacPhylum) {
APS = subset_taxa(physeq.prune.rarefy.SF, Phylum == i)
APS.plot = plot_richness(APS, x="Site_layer", color =("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "cadetblue3", "palegreen2")) + ggtitle(i) + stat_compare_means(method = "anova") + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73"))
print(APS.plot)
}
dev.off()
pdf("./Figures/Bacterial Phylum Alpha (Observed) Diversity by Site.pdf", width = 8, height = 5 )
for (i in BacPhylum) {
APS = subset_taxa(physeq.prune.rarefy.SF, Phylum == i)
APS.plot = plot_richness(APS, x="Site", color =("Site"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "cadetblue3", "palegreen2")) + ggtitle(i) + stat_compare_means(method = "anova") + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73"))
print(APS.plot)
}
dev.off()
taxcom_site = ggplot(data = psmelt(physeq.prune.rarefy.SF), mapping = aes_string(x = "Site" ,y = "Abundance", fill = "Phylum" )) +
geom_bar(stat="identity", position="fill") +
ggtitle("Bacterial Taxonomic Composition by Site")+
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
theme(plot.title = element_text(hjust = 0.5))
#print(taxcom_sitelayer)
pdf("./Figures/Bacterial Taxonomic Composition by Site.pdf", width = 10, height = 6 )
taxcom_site
dev.off()
knitr::opts_chunk$set(echo = TRUE)
library(ape)
library(vegan)
library(plyr)
library(dplyr)
library(scales)
library(grid)
library(reshape2)
library(phyloseq)
library(magrittr)
library(ggplot2)
library(ggpubr)
library(data.table)
library(tidyr)
library(tidyverse)
otu = read.table(file="MojaveBacQ2FWLEsilva515806.otu_table.fix.txt", header=T, sep='\t')
dim(otu)
tax <- read.table(file="taxonomy.fix.tsv", sep='\t', header=TRUE)
head(tax)
dim(tax)
tax_filtered <- tax[tax$OTU.ID %in% otu$OTU.ID,]
head(tax_filtered)
dim(tax_filtered)
dim(otu)
tax_filtered = tax_filtered[,c(1,2)]
tax_filtered = separate(tax_filtered, Taxon, c("Kingdom","Phylum","Class","Order", "Family", "Genus","Species"), sep= ";", remove=TRUE)
dim(tax_filtered)
head(tax_filtered)
write.csv(tax_filtered, file="taxonomy_phyloseq_fix.csv")
otus <- read.table("MojaveBacQ2FWLEsilva515806.otu_table.fix.txt",
header=T,sep="\t",row.names = 1)
otumat <- as(as.matrix(otus), "matrix")
OTU = otu_table(otumat, taxa_are_rows = TRUE)
taxmat <- read.csv("taxonomy_phyloseq_fix.csv",
sep=",",row.names=1)
row.names(taxmat) = taxmat$OTU.ID
taxmat <- as(as.matrix(taxmat),"matrix")
TAX = tax_table(taxmat)
treefile = "tree.nwk"
tree = read.tree(treefile)
meta = read.table("Mojave_mappingfile_8-Aug-2018.txt",
header=TRUE,row.names=1,
sep="\t",stringsAsFactors=FALSE)
#meta <- meta[which(meta$Layer %in% c("Surface")),]
sampleData <- sample_data(meta)
physeq = phyloseq(OTU,TAX,sampleData,tree)
physeq
physeq.prune = prune_taxa(taxa_sums(physeq) > 5, physeq)
physeq.prune
readcount = data.table(as(sample_data(physeq.prune), "data.frame"),
TotalReads = sample_sums(physeq.prune),
keep.rownames = TRUE)
setnames(readcount, "rn", "SampleID")
#For plotting, use command below.
#SeqDepth = ggplot(readcount, aes(TotalReads)) + geom_histogram() + ggtitle("Sequencing Depth")
readcount = readcount[order(readcount$TotalReads), c("SampleID", "TotalReads")]
head(readcount)
set.seed(711)
physeq.prune.rarefy = rarefy_even_depth(physeq.prune, sample.size = 37435, replace = FALSE, trimOTUs = TRUE)
physeq.prune.rarefy
physeq.prune.rarefy.SF = subset_samples(physeq.prune.rarefy, Layer=="Surface")
sample_data(physeq.prune.rarefy.SF)$Crust_type = factor(sample_data(physeq.prune.rarefy.SF)$Crust_type, levels = c("LAC","CLC", "GLC", "RMC", "SMC"))
alpha.diversity = estimate_richness(physeq.prune.rarefy.SF, measures = c("Observed"))
data.anova = cbind(sample_data(physeq.prune.rarefy.SF), alpha.diversity)
physeq.prune.rarefy.SF.anova = aov(Observed ~ Crust_type, data.anova)
summary(physeq.prune.rarefy.SF.anova)
tukey.ps.SF = TukeyHSD(x=physeq.prune.rarefy.SF.anova, 'Crust_type', conf.level = 0.95)
generate_label_df <- function(tukey.ps.SF, variable){
# Extract labels and factor levels from Tukey post-hoc
Tukey.levels <- tukey.ps.SF[[variable]][,4]
Tukey.labels <- data.frame(multcompLetters(Tukey.levels)['Letters'])
#I need to put the labels in the same order as in the boxplot :
Tukey.labels$treatment=rownames(Tukey.labels)
Tukey.labels=Tukey.labels[order(Tukey.labels$treatment) , ]
return(Tukey.labels)
}
LABELS=generate_label_df(tukey.ps.SF, 'Crust_type')
library(multcompView)
LABELS=generate_label_df(tukey.ps.SF, 'Crust_type')
names(LABELS) = c('Letters','Crust_type')
physeq.prune.rarefy.plot.richness.Crust_type = plot_richness(physeq.prune.rarefy.SF, x="Crust_type", color=("Crust_type"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "cadetblue3", "palegreen2", "lightpink")) + ggtitle("Bacterial Alpha Diversity by Crust_type") + stat_compare_means(method = "anova", label.y = 1222) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73", "CC79A7")) + geom_text(data=LABELS, aes(x=LABELS$Crust_type, y = 1150, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Crust_type
physeq.prune.rarefy.plot.richness.Crust_type = plot_richness(physeq.prune.rarefy.SF, x="Crust_type", color=("Crust_type"), measures=c("Observed")) + geom_boxplot(lwd=1,fill=c("#999999", "gold2", "cadetblue3", "palegreen2", "lightpink")) + ggtitle("Bacterial Alpha Diversity by Crust_type") + stat_compare_means(method = "anova", label.y = 1222) + theme(plot.title = element_text(hjust = 0.5)) + scale_colour_manual(values = c("#000000", "#E69F00", "#56B4E9", "#009E73", "#CC79A7")) + geom_text(data=LABELS, aes(x=LABELS$Crust_type, y = 1150, label = LABELS$Letters))
physeq.prune.rarefy.plot.richness.Crust_type
pdf("./Figures/Bacterial Alpha (Observed) Diversity by Crust type PLPA250.pdf", width = 8, height = 5 )
physeq.prune.rarefy.plot.richness.Crust_type
dev.off()
